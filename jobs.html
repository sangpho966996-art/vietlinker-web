<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Vi·ªác L√†m - VietLinker</title>
    <style>
        :root{
            --primary:#1e3c72;
            --accent:#dc143c;
            --gold:#FFD700;
            --text:#1f2937;
            --muted:#6b7280;
            --bg:#f8f9fa;
            --card:#ffffff;
            --ring:#e5e7eb;
        }
        *{margin:0;padding:0;box-sizing:border-box}
        body{
            font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;
            background:#ffffff;min-height:100vh;line-height:1.6;color:var(--text)
        }

        /* Header */
        header{
            background:linear-gradient(135deg,var(--primary) 0%,var(--accent) 100%);
            position:relative;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,0.1)
        }
        header::before{
            content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;
            background:radial-gradient(circle,rgba(255,255,255,0.08) 0%,transparent 70%);
            animation:shimmer 3s infinite
        }
        header::after{
            content:'';position:absolute;bottom:0;left:0;right:0;height:1px;
            background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent)
        }
        @keyframes shimmer{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}

        .header-content{
            max-width:1400px;margin:0 auto;padding:12px 20px;
            display:flex;justify-content:space-between;align-items:center;position:relative;z-index:1
        }
        .logo{display:flex;align-items:center;gap:12px;text-decoration:none;transition:transform .3s}
        .logo:hover{transform:scale(1.04)}
        .logo svg{width:48px;height:48px;filter:drop-shadow(0 2px 4px rgba(0,0,0,0.08))}
        .logo-text{color:#fff;font-size:22px;font-weight:700;letter-spacing:-.3px}

        .user-actions{display:flex;gap:12px;align-items:center}
        .user-info{display:none;align-items:center;gap:10px;background:rgba(255,255,255,.12);
            padding:6px 12px;border-radius:999px;backdrop-filter:blur(8px);position:relative}
        .user-info.active{display:flex}
        .user-avatar{
            width:34px;height:34px;background:linear-gradient(135deg,#FFD700,#FFA500);color:var(--primary);
            border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;
            box-shadow:0 2px 8px rgba(0,0,0,0.1)
        }
        .user-name{color:#fff;font-weight:600}

        .user-dropdown{
            position:absolute;top:100%;right:0;margin-top:8px;background:#fff;border-radius:12px;
            box-shadow:0 10px 30px rgba(0,0,0,.16);min-width:200px;opacity:0;visibility:hidden;
            transform:translateY(-8px);transition:all .25s ease;z-index:1000
        }
        .user-info:hover .user-dropdown{opacity:1;visibility:visible;transform:translateY(0)}
        .dropdown-item{
            display:flex;align-items:center;gap:10px;padding:12px 16px;color:#333;text-decoration:none;
            transition:all .2s;border-bottom:1px solid #f3f4f6
        }
        .dropdown-item:last-child{border-bottom:none}
        .dropdown-item:hover{background:#f8f9fa;color:var(--accent)}
        .dropdown-item.signout{color:var(--accent);font-weight:700}
        .dropdown-item.signout:hover{background:var(--accent);color:#fff}

        .auth-buttons{display:flex;gap:10px}
        .auth-buttons.hidden{display:none}
        .btn-auth{padding:8px 16px;border-radius:999px;text-decoration:none;font-weight:700;transition:all .2s;font-size:14px}
        .btn-login{background:rgba(255,255,255,.16);color:#fff;border:2px solid #fff}
        .btn-register{background:linear-gradient(135deg,#FFD700,#FFA500);color:var(--primary);box-shadow:0 4px 12px rgba(255,215,0,.28)}

        .btn-post{
            background:linear-gradient(135deg,#28a745,#20c997);color:#fff;padding:8px 16px;border-radius:10px;
            text-decoration:none;font-weight:800;transition:all .2s;font-size:14px;display:inline-flex;align-items:center;gap:8px;
            box-shadow:0 4px 14px rgba(40,167,69,.28)
        }
        .btn-auth:hover,.btn-post:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(0,0,0,.16)}

        /* Floating Post Button */
        .floating-post-btn{
            position:fixed;bottom:20px;right:20px;width:56px;height:56px;z-index:999;
            background:linear-gradient(135deg,var(--accent),#b91c3c);border-radius:50%;display:flex;align-items:center;justify-content:center;
            text-decoration:none;color:#fff;font-size:24px;box-shadow:0 6px 22px rgba(220,20,60,.42);transition:all .25s
        }
        .floating-post-btn:hover{transform:scale(1.06);box-shadow:0 10px 28px rgba(220,20,60,.58)}
        .floating-post-btn::after{
            content:'ƒêƒÉng tin';position:absolute;right:68px;background:#111827;color:#fff;padding:6px 10px;border-radius:6px;
            font-size:12px;font-weight:700;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity .2s
        }
        .floating-post-btn:hover::after{opacity:1}

        /* Nav */
        nav{
            background:var(--primary);box-shadow:0 2px 14px rgba(0,0,0,.08);position:sticky;top:0;z-index:1000;
            border-bottom:3px solid rgba(220,20,60,.28)
        }
        .nav-container{max-width:1400px;margin:0 auto;padding:0 16px}
        .nav-links{display:flex;gap:6px;padding:10px 0;align-items:center}
        .nav-links a{
            color:#fff;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all .2s;font-weight:700;font-size:14px;
            display:flex;align-items:center;gap:6px;white-space:nowrap
        }
        .nav-links a:hover{background:rgba(220,20,60,.28);transform:translateY(-1px)}
        .nav-links a.active{background:linear-gradient(135deg,var(--accent),#b91c3c);box-shadow:0 4px 10px rgba(220,20,60,.28)}
        .nav-divider{width:1px;height:22px;background:rgba(255,255,255,.22);margin:0 6px}
        .user-menu{display:none;gap:6px}
        .user-menu.active{display:flex}

        /* Main Content */
        .main-content{padding:16px;background:var(--bg);min-height:calc(100vh - 200px)}
        .actions-bar{
            display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:12px;
            background:var(--card);padding:12px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.04);max-width:1400px;margin:0 auto 16px
        }
        .search-bar{display:flex;gap:10px;flex:1;max-width:100%;flex-wrap:wrap}
        .location-input{
            display:flex;align-items:center;gap:6px;padding:10px 12px;background:#fff;border:2px solid var(--ring);border-radius:10px;min-width:180px;flex:1
        }
        .location-input input{border:none;outline:none;flex:1;font-size:15px;padding:0}
        .location-icon{color:var(--accent);font-size:16px}
        .location-input:focus-within{border-color:var(--primary)}

        .search-bar input,.search-bar select{
            flex:1;padding:10px 12px;border:2px solid var(--ring);border-radius:10px;font-size:15px;min-width:140px;background:#fff
        }

        .btn{
            background:linear-gradient(135deg,var(--accent),#b91c3c);color:#fff;border:none;padding:10px 16px;border-radius:10px;cursor:pointer;
            font-size:14px;font-weight:800;transition:all .2s;box-shadow:0 4px 14px rgba(220,20,60,.28)
        }
        .btn:hover{transform:translateY(-1px);box-shadow:0 8px 22px rgba(220,20,60,.36)}

        .jobs-container{display:grid;gap:12px;max-width:1400px;margin:0 auto;grid-template-columns:repeat(auto-fill,minmax(280px,1fr))}
        .job-card{
            background:#fff;border-radius:14px;padding:16px;box-shadow:0 3px 12px rgba(0,0,0,.06);transition:all .25s;cursor:pointer;display:flex;gap:12px
        }
        .job-card:hover{transform:translateY(-4px);box-shadow:0 12px 28px rgba(0,0,0,.12)}

        .job-image{
            width:96px;height:96px;background:#f3f4f6;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#9ca3af;font-size:22px;flex-shrink:0;overflow:hidden
        }
        .job-image img{width:100%;height:100%;object-fit:cover}

        .job-content{flex:1}
        .job-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px;gap:10px}
        .job-title{font-size:1.05rem;color:var(--primary);font-weight:800;line-height:1.3}
        .job-type{background:linear-gradient(135deg,#1e3c72,#2a5298);color:#fff;padding:4px 10px;border-radius:999px;font-size:.8rem;font-weight:800;white-space:nowrap}
        .company-name{color:var(--accent);font-weight:800;margin-top:2px;margin-bottom:6px}
        .job-description{color:#4b5563;line-height:1.6;margin-bottom:10px;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;font-size:.95rem}
        .job-details{display:flex;gap:12px;flex-wrap:wrap;padding-top:10px;border-top:1px solid #f1f5f9}
        .job-detail-item{display:flex;align-items:center;gap:6px;color:#555;font-size:.9rem}
        .job-detail-item .icon{color:var(--accent)}
        .view-count{color:#9ca3af;font-size:.8rem;margin-top:8px}

        .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.55);z-index:1000;overflow-y:auto;backdrop-filter:blur(4px)}
        .modal-content{background:#fff;margin:40px auto;padding:0;width:92%;max-width:700px;border-radius:14px;animation:slideDown .25s;overflow:hidden}
        .modal-header{background:linear-gradient(135deg,#1e3c72,var(--accent));color:#fff;padding:18px;display:flex;justify-content:space-between;align-items:center}
        .modal-header h2{font-size:1.3rem}
        .close-modal{font-size:26px;color:#fff;cursor:pointer;transition:transform .2s;background:none;border:none}
        .close-modal:hover{transform:rotate(90deg)}
        .modal-body{padding:18px;max-height:72vh;overflow-y:auto}

        .form-group{margin-bottom:14px}
        .form-group label{display:block;margin-bottom:6px;font-weight:800;color:var(--primary);font-size:.95rem}
        .form-group input,.form-group textarea,.form-group select{
            width:100%;padding:10px 12px;border:2px solid var(--ring);border-radius:10px;font-size:15px;transition:border-color .2s;background:#fff
        }
        .form-group input:focus,.form-group textarea:focus,.form-group select:focus{outline:none;border-color:var(--accent)}
        .form-group textarea{resize:vertical;min-height:110px}

        .upload-area{
            border:2px dashed var(--ring);border-radius:10px;padding:28px 16px;text-align:center;cursor:pointer;transition:all .2s;background:#f9fafb
        }
        .upload-area:hover{border-color:var(--accent);background:#fff}
        .upload-area.dragover{border-color:var(--accent);background:#fff5f5}
        .upload-preview{max-width:200px;max-height:200px;margin:10px auto;border-radius:8px;overflow:hidden}
        .upload-preview img{width:100%;height:100%;object-fit:cover}

        .form-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:10px;padding-top:10px;border-top:2px solid #f1f5f9}

        .detail-modal .modal-content{max-width:800px}
        .detail-header{display:flex;gap:14px;margin-bottom:12px}
        .detail-image{width:180px;height:180px;background:#f3f4f6;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#9ca3af;font-size:22px;flex-shrink:0;overflow:hidden}
        .detail-image img{width:100%;height:100%;object-fit:cover}
        .detail-info h3{font-size:1.4rem;color:var(--primary);margin-bottom:4px}
        .detail-company{color:var(--accent);font-size:1rem;font-weight:800;margin-bottom:8px}
        .detail-type{display:inline-block;background:linear-gradient(135deg,#1e3c72,#2a5298);color:#fff;padding:6px 12px;border-radius:999px;font-size:.9rem;margin-bottom:10px}
        .detail-description{color:#4b5563;line-height:1.8;font-size:1rem;margin-bottom:14px;white-space:pre-wrap}
        .detail-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(190px,1fr));gap:10px;margin-bottom:10px}
        .detail-item{display:flex;align-items:center;gap:8px;padding:10px;background:#f8fafc;border-radius:10px;color:#555}
        .detail-item .icon{color:var(--accent);font-size:18px}

        .loading{text-align:center;padding:40px;color:#666}
        .empty-state{text-align:center;padding:40px 16px;color:#9ca3af;background:#fff;border-radius:12px}

        @keyframes slideDown{from{opacity:0;transform:translateY(-36px)}to{opacity:1;transform:translateY(0)}}

        /* Footer */
        footer{background:var(--primary);color:#fff;padding:40px 16px 24px}
        .footer-content{max-width:1400px;margin:0 auto;display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:26px;margin-bottom:24px}
        .footer-brand h3{font-size:22px;margin-bottom:10px;display:flex;align-items:center;gap:8px}
        .footer-brand p{color:rgba(255,255,255,.86);line-height:1.6;margin-bottom:12px}
        .social-links{display:flex;gap:10px}
        .social-link{width:36px;height:36px;background:rgba(255,255,255,.12);border-radius:50%;display:flex;align-items:center;justify-content:center;text-decoration:none;color:#fff;transition:all .2s}
        .social-link:hover{background:var(--accent);transform:translateY(-2px)}
        .footer-column h4{font-size:16px;margin-bottom:12px;color:var(--gold)}
        .footer-column ul{list-style:none}
        .footer-column ul li{margin-bottom:8px}
        .footer-column ul li a{color:rgba(255,255,255,.86);text-decoration:none;transition:color .2s}
        .footer-column ul li a:hover{color:var(--gold)}
        .footer-bottom{padding-top:18px;border-top:1px solid rgba(255,255,255,.12);text-align:center;color:rgba(255,255,255,.7);font-size:.95rem}

        /* Responsive */
        @media (max-width: 1024px){
            .footer-content{grid-template-columns:repeat(2,1fr)}
        }
        @media (max-width: 768px){
            .header-content{padding:12px 14px}
            .logo-text{font-size:20px}
            .user-name{display:none}
            .nav-links{overflow-x:auto;-webkit-overflow-scrolling:touch}
            .nav-divider{display:none}

            .actions-bar{padding:10px}
            .search-bar{flex-direction:column}
            .location-input{min-width:auto;width:100%}
            .search-bar input,.search-bar select{min-width:auto;width:100%}

            .jobs-container{grid-template-columns:1fr}
            .job-card{flex-direction:column;padding:14px}
            .job-image{width:100%;height:160px}

            .detail-header{flex-direction:column}
            .detail-image{width:100%;height:220px}
            .floating-post-btn{width:52px;height:52px;bottom:16px;right:16px;font-size:22px}
            .btn,.btn-post,.btn-auth{padding:9px 14px;font-size:14px}
        }
        @media (max-width: 480px){
            .logo-text{font-size:18px}
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="index.html" class="logo" aria-label="VietLinker">
                <svg viewBox="0 0 100 100" aria-hidden="true">
                    <circle cx="50" cy="50" r="45" fill="white" opacity="0.95"/>
                    <circle cx="50" cy="25" r="8" fill="#dc143c"/>
                    <circle cx="25" cy="50" r="8" fill="#FFD700"/>
                    <circle cx="75" cy="50" r="8" fill="#FFD700"/>
                    <circle cx="50" cy="75" r="8" fill="#1e3c72"/>
                    <line x1="50" y1="25" x2="25" y2="50" stroke="#dc143c" stroke-width="2" opacity="0.5"/>
                    <line x1="50" y1="25" x2="75" y2="50" stroke="#dc143c" stroke-width="2" opacity="0.5"/>
                    <line x1="25" y1="50" x2="50" y2="75" stroke="#FFD700" stroke-width="2" opacity="0.5"/>
                    <line x1="75" y1="50" x2="50" y2="75" stroke="#FFD700" stroke-width="2" opacity="0.5"/>
                </svg>
                <span class="logo-text">VietLinker</span>
            </a>

            <div class="user-actions">
                <a href="post-form.html" class="btn-post" id="postButton">‚úçÔ∏è ƒêƒÉng tin</a>

                <div class="user-info" id="userInfo">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <span class="user-name" id="userName">User</span>
                    <div class="user-dropdown">
                        <a href="profile.html" class="dropdown-item">üë§ H·ªì S∆° C√° Nh√¢n</a>
                        <a href="my-posts.html" class="dropdown-item">üìù Qu·∫£n L√Ω Tin ƒêƒÉng</a>
                        <a href="post-form.html" class="dropdown-item">‚ûï ƒêƒÉng Tin M·ªõi</a>
                        <a href="#" onclick="signOut()" class="dropdown-item signout">üö™ ƒêƒÉng Xu·∫•t</a>
                    </div>
                </div>

                <div class="auth-buttons" id="authButtons">
                    <a href="login.html" class="btn-auth btn-login">ƒêƒÉng Nh·∫≠p</a>
                    <a href="register.html" class="btn-auth btn-register">ƒêƒÉng K√Ω Ngay</a>
                </div>
            </div>
        </div>
    </header>

    <nav>
        <div class="nav-container">
            <div class="nav-links">
                <a href="index.html">üè† Trang Ch·ªß</a>

                <div class="user-menu" id="userMenu">
                    <div class="nav-divider"></div>
                    <a href="profile.html">üë§ H·ªì S∆°</a>
                    <a href="my-posts.html">üìù Tin ƒêƒÉng</a>
                    <div class="nav-divider"></div>
                </div>

                <a href="marketplace.html">üõí Mua B√°n</a>
                <a href="jobs.html" class="active">üíº Vi·ªác L√†m</a>
                <a href="services.html">ü§ù D·ªãch V·ª•</a>
                <a href="food.html">üçú ƒÇn U·ªëng</a>
                <a href="realestate.html">üè† BƒêS & Ti·ªám</a>
                <a href="classifieds.html">üìã Rao V·∫∑t</a>
                <a href="promotions.html">üéÅ Khuy·∫øn M√£i</a>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div class="actions-bar">
            <div class="search-bar">
                <div class="location-input">
                    <span class="location-icon">üìç</span>
                    <input type="text" id="locationInput" placeholder="Zipcode ho·∫∑c Th√†nh ph·ªë" aria-label="Khu v·ª±c">
                </div>
                <select id="typeFilter" aria-label="Lo·∫°i c√¥ng vi·ªác">
                    <option value="">T·∫•t c·∫£ lo·∫°i</option>
                    <option value="full-time">Full-time</option>
                    <option value="part-time">Part-time</option>
                    <option value="contract">Contract</option>
                    <option value="temporary">Temporary</option>
                </select>
                <select id="salaryFilter" aria-label="M·ª©c l∆∞∆°ng">
                    <option value="">T·∫•t c·∫£ m·ª©c l∆∞∆°ng</option>
                    <option value="under-15">D∆∞·ªõi $15/gi·ªù</option>
                    <option value="15-20">$15-20/gi·ªù</option>
                    <option value="20-25">$20-25/gi·ªù</option>
                    <option value="above-25">Tr√™n $25/gi·ªù</option>
                </select>
                <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm vi·ªác l√†m..." aria-label="T·ª´ kh√≥a">
            </div>
            <button class="btn" id="postJobBtn" aria-label="ƒêƒÉng tin tuy·ªÉn d·ª•ng">+ ƒêƒÉng tin tuy·ªÉn d·ª•ng</button>
        </div>

        <div id="jobsContainer" class="jobs-container">
            <div class="loading">ƒêang t·∫£i vi·ªác l√†m...</div>
        </div>
    </div>

    <!-- Modal ƒëƒÉng vi·ªác -->
    <div id="jobModal" class="modal" role="dialog" aria-modal="true" aria-label="ƒêƒÉng Tin Tuy·ªÉn D·ª•ng">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìù ƒêƒÉng Tin Tuy·ªÉn D·ª•ng</h2>
                <button class="close-modal" aria-label="ƒê√≥ng">&times;</button>
            </div>
            <div class="modal-body">
                <form id="jobForm">
                    <div class="form-group">
                        <label for="title">V·ªã tr√≠ tuy·ªÉn d·ª•ng *</label>
                        <input type="text" id="title" required placeholder="VD: Th·ª£ Nail, Ph·ª• b·∫øp, Sales...">
                    </div>

                    <div class="form-group">
                        <label for="company">T√™n c√¥ng ty/ti·ªám *</label>
                        <input type="text" id="company" required placeholder="VD: Ti·ªám Nail H·ªìng">
                    </div>

                    <div class="form-group">
                        <label for="description">M√¥ t·∫£ c√¥ng vi·ªác *</label>
                        <textarea id="description" required placeholder="M√¥ t·∫£ chi ti·∫øt v·ªÅ c√¥ng vi·ªác, y√™u c·∫ßu, quy·ªÅn l·ª£i..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="job_type">Lo·∫°i c√¥ng vi·ªác *</label>
                        <select id="job_type" required>
                            <option value="">Ch·ªçn lo·∫°i</option>
                            <option value="full-time">Full-time</option>
                            <option value="part-time">Part-time</option>
                            <option value="contract">Contract</option>
                            <option value="temporary">Temporary</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="salary">M·ª©c l∆∞∆°ng</label>
                        <input type="text" id="salary" placeholder="VD: $15-20/gi·ªù ho·∫∑c Th∆∞∆°ng l∆∞·ª£ng">
                    </div>

                    <div class="form-group">
                        <label for="location">ƒê·ªãa ch·ªâ l√†m vi·ªác</label>
                        <input type="text" id="location" placeholder="VD: 123 Main St, Houston, TX">
                    </div>

                    <div class="form-group">
                        <label for="city">Th√†nh ph·ªë *</label>
                        <input type="text" id="city" required placeholder="VD: Houston, Dallas, Austin...">
                    </div>

                    <div class="form-group">
                        <label for="zipcode">Zipcode *</label>
                        <input type="text" id="zipcode" required placeholder="VD: 77001" pattern="[0-9]{5}" maxlength="5">
                    </div>

                    <div class="form-group">
                        <label for="contact">Th√¥ng tin li√™n h·ªá *</label>
                        <input type="text" id="contact" required placeholder="S·ªë ƒëi·ªán tho·∫°i ho·∫∑c email">
                    </div>

                    <div class="form-group">
                        <label>H√¨nh ·∫£nh c√¥ng ty/ti·ªám</label>
                        <div class="upload-area" id="uploadArea" aria-label="T·∫£i ·∫£nh">
                            <div id="uploadText">
                                üì∑ K√©o th·∫£ ho·∫∑c click ƒë·ªÉ ch·ªçn h√¨nh ·∫£nh<br>
                                <small>PNG, JPG, GIF (t·ªëi ƒëa 5MB)</small>
                            </div>
                            <div id="uploadPreview" class="upload-preview" style="display: none;"></div>
                        </div>
                        <input type="file" id="imageInput" accept="image/*" style="display: none;">
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn" style="background:#6b7280" onclick="closeModal()">H·ªßy</button>
                        <button type="submit" class="btn">ƒêƒÉng tin</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal xem chi ti·∫øt -->
    <div id="detailModal" class="modal detail-modal" role="dialog" aria-modal="true" aria-label="Chi Ti·∫øt C√¥ng Vi·ªác">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìã Chi Ti·∫øt C√¥ng Vi·ªác</h2>
                <button class="close-modal" onclick="closeDetailModal()" aria-label="ƒê√≥ng">&times;</button>
            </div>
            <div class="modal-body" id="detailContent"></div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-brand">
                <h3>
                    <svg width="30" height="30" viewBox="0 0 100 100" aria-hidden="true">
                        <circle cx="50" cy="50" r="45" fill="white" opacity="0.95"/>
                        <circle cx="50" cy="25" r="8" fill="#dc143c"/>
                        <circle cx="25" cy="50" r="8" fill="#FFD700"/>
                        <circle cx="75" cy="50" r="8" fill="#FFD700"/>
                        <circle cx="50" cy="75" r="8" fill="#1e3c72"/>
                    </svg>
                    VietLinker
                </h3>
                <p>N·ªÅn t·∫£ng k·∫øt n·ªëi c·ªông ƒë·ªìng ng∆∞·ªùi Vi·ªát t·∫°i M·ªπ. Mang ƒë·∫øn c∆° h·ªôi, k·∫øt n·ªëi v√† ph√°t tri·ªÉn cho c·ªông ƒë·ªìng.</p>
                <div class="social-links">
                    <a href="#" class="social-link" aria-label="Facebook">f</a>
                    <a href="#" class="social-link" aria-label="Twitter">t</a>
                    <a href="#" class="social-link" aria-label="Instagram">i</a>
                    <a href="#" class="social-link" aria-label="YouTube">y</a>
                </div>
            </div>

            <div class="footer-column">
                <h4>Danh M·ª•c</h4>
                <ul>
                    <li><a href="marketplace.html">Mua B√°n</a></li>
                    <li><a href="jobs.html">Vi·ªác L√†m</a></li>
                    <li><a href="services.html">D·ªãch V·ª•</a></li>
                    <li><a href="food.html">ƒÇn U·ªëng</a></li>
                    <li><a href="realestate.html">B·∫•t ƒê·ªông S·∫£n</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h4>H·ªó Tr·ª£</h4>
                <ul>
                    <li><a href="contact.html">Li√™n H·ªá</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h4>V·ªÅ VietLinker</h4>
                <ul>
                    <li><a href="about.html">Gi·ªõi Thi·ªáu</a></li>
                    <li><a href="terms.html">ƒêi·ªÅu Kho·∫£n</a></li>
                    <li><a href="privacy.html">Ch√≠nh S√°ch B·∫£o M·∫≠t</a></li>
                    <li><a href="contact.html?topic=ads">Qu·∫£ng C√°o</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2024 VietLinker. T·∫•t c·∫£ quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u. Made with ‚ù§Ô∏è for Vietnamese Community</p>
        </div>
    </footer>

    <a href="#" class="floating-post-btn" id="floatingPostBtn" aria-label="ƒêƒÉng tin">‚ûï</a>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>
    <script>
        console.log('üî• Jobs V2 Script loading...');

        // Global variables
        var supabase;
        var currentUser = null;
        var selectedFile = null;
        var allJobs = [];
        var filterDebounceTimer = null;

        // Supabase config
        var SUPABASE_URL = 'https://wwlmvcsozavqfvwlxkrt.supabase.co';
        var SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind3bG12Y3NvemF2cWZ2d2x4a3J0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzNzUyMTMsImV4cCI6MjA2OTk1MTIxM30.HdxvLlqJgdntVUQDVtVlkjJJa7bn9CoIVUG8yn3WkLQ';

        function escapeHtml(text){
            var span = document.createElement('span');
            span.textContent = text == null ? '' : String(text);
            return span.innerHTML;
        }

        function debounce(fn, wait){
            return function(){
                var ctx = this, args = arguments;
                clearTimeout(filterDebounceTimer);
                filterDebounceTimer = setTimeout(function(){ fn.apply(ctx, args); }, wait);
            };
        }

        function salaryMatchesFilter(salaryText, filterValue){
            if(!filterValue || !salaryText) return true;
            var text = (salaryText + '').toLowerCase();
            // Extract numbers: range or single
            var nums = (text.match(/(\d+(\.\d+)?)/g) || []).map(function(n){ return parseFloat(n); });
            var low = null, high = null;
            if(nums.length >= 2){ low = Math.min(nums[0], nums[1]); high = Math.max(nums[0], nums[1]); }
            else if(nums.length === 1){ low = nums[0]; high = nums[0]; }
            else{
                // If no number and user wants "all" return true, otherwise treat as non-match
                return filterValue === '';
            }

            function inRange(min, max){
                if(low === null) return false;
                var avg = (low + (high || low)) / 2;
                return avg >= min && avg <= max;
            }

            if(filterValue === 'under-15') return low !== null && (high || low) < 15 || inRange(0,14.99);
            if(filterValue === '15-20') return inRange(15,20);
            if(filterValue === '20-25') return inRange(20,25);
            if(filterValue === 'above-25') return (low !== null && low > 25) || (high !== null && high > 25);
            return true;
        }

        // Initialize app
        function initializeApp(){
            console.log('üöÄ Initializing app...');
            var supabaseLib = window.supabase || window.Supabase;

            if(supabaseLib){
                console.log('‚úÖ Supabase library found');
                supabase = supabaseLib.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('‚úÖ Supabase client created');

                setupUpload();
                setupEvents();
                checkAuth();
                loadJobs();
            }else{
                console.log('‚è≥ Waiting for Supabase...');
                setTimeout(initializeApp, 500);
            }
        }

        window.onload = function(){
            console.log('üöÄ Page loaded');
            initializeApp();
        };

        function setupUpload(){
            console.log('üì∑ Setting up upload...');
            var uploadArea = document.getElementById('uploadArea');
            var imageInput = document.getElementById('imageInput');
            if(!uploadArea || !imageInput){ console.error('‚ùå Upload elements not found'); return; }

            uploadArea.onclick = function(){ imageInput.click(); };
            imageInput.onchange = function(e){
                if(e.target.files && e.target.files[0]) handleFileSelect(e.target.files[0]);
            };
            uploadArea.ondragover = function(e){ e.preventDefault(); uploadArea.classList.add('dragover'); };
            uploadArea.ondragleave = function(){ uploadArea.classList.remove('dragover'); };
            uploadArea.ondrop = function(e){
                e.preventDefault(); uploadArea.classList.remove('dragover');
                if(e.dataTransfer.files.length > 0) handleFileSelect(e.dataTransfer.files[0]);
            };
        }

        function handleFileSelect(file){
            console.log('üì∑ Processing file:', file.name);
            if(file.size > 5*1024*1024){ alert('File qu√° l·ªõn! T·ªëi ƒëa 5MB.'); return; }
            if(!file.type.startsWith('image/')){ alert('Ch·ªâ ch·∫•p nh·∫≠n file h√¨nh ·∫£nh!'); return; }

            selectedFile = file;
            var reader = new FileReader();
            reader.onload = function(e){
                var preview = document.getElementById('uploadPreview');
                var text = document.getElementById('uploadText');
                if(preview && text){
                    preview.innerHTML = '<img src="'+ e.target.result +'" alt="Preview">';
                    preview.style.display = 'block';
                    text.style.display = 'none';
                }
            };
            reader.readAsDataURL(file);
        }

        function setupEvents(){
            console.log('üîß Setting up events...');
            var postBtn = document.getElementById('postJobBtn');
            var floatingBtn = document.getElementById('floatingPostBtn');

            function openJobModal(){
                if(!currentUser){
                    alert('Vui l√≤ng ƒëƒÉng nh·∫≠p!');
                    window.location.href = 'login.html';
                    return;
                }
                document.getElementById('jobModal').style.display = 'block';
            }

            if(postBtn) postBtn.onclick = openJobModal;
            if(floatingBtn){
                floatingBtn.onclick = function(e){ e.preventDefault(); openJobModal(); };
            }

            var jobForm = document.getElementById('jobForm');
            if(jobForm){
                jobForm.onsubmit = function(e){ e.preventDefault(); handleSubmit(); };
            }

            var closeButtons = document.querySelectorAll('.close-modal');
            for(var i=0;i<closeButtons.length;i++){
                closeButtons[i].onclick = function(){
                    var modal = this.closest('.modal');
                    if(modal) modal.style.display = 'none';
                };
            }
            window.onclick = function(e){
                if(e.target.classList && e.target.classList.contains('modal')){
                    e.target.style.display = 'none';
                }
            };

            setupFilters();
        }

        function setupFilters(){
            var searchInput = document.getElementById('searchInput');
            var typeFilter = document.getElementById('typeFilter');
            var salaryFilter = document.getElementById('salaryFilter');
            var locationInput = document.getElementById('locationInput');

            var applyFilters = function(){
                var type = typeFilter ? typeFilter.value : '';
                var location = locationInput ? locationInput.value : '';
                var salary = salaryFilter ? salaryFilter.value : '';
                var search = searchInput ? searchInput.value : '';
                loadJobs(type, search, location, salary);
            };

            var debouncedApply = debounce(applyFilters, 400);

            if(searchInput) searchInput.oninput = debouncedApply;
            if(typeFilter) typeFilter.onchange = applyFilters;
            if(salaryFilter) salaryFilter.onchange = applyFilters;
            if(locationInput) locationInput.oninput = debouncedApply;
        }

        function checkAuth(){
            console.log('üîê Checking auth...');
            supabase.auth.getUser().then(function(response){
                var user = response.data.user;
                currentUser = user;

                var userInfo = document.getElementById('userInfo');
                var authButtons = document.getElementById('authButtons');
                var userMenu = document.getElementById('userMenu');
                var userName = document.getElementById('userName');
                var userAvatar = document.getElementById('userAvatar');

                if(user){
                    if(userInfo) userInfo.classList.add('active');
                    if(authButtons) authButtons.classList.add('hidden');
                    if(userMenu) userMenu.classList.add('active');
                    if(userName) userName.textContent = (user.email || 'User').split('@')[0];
                    if(userAvatar) userAvatar.textContent = (user.email || 'U').charAt(0).toUpperCase();
                    console.log('‚úÖ User logged in:', user.email);
                }else{
                    if(userInfo) userInfo.classList.remove('active');
                    if(authButtons) authButtons.classList.remove('hidden');
                    if(userMenu) userMenu.classList.remove('active');
                }
            });
        }

        function signOut(){
            if(supabase){
                supabase.auth.signOut().then(function(){
                    window.location.href = 'login.html';
                });
            }
        }
        window.signOut = signOut;

        function handleSubmit(){
            console.log('üìù Form submitted');
            if(!currentUser){ alert('Vui l√≤ng ƒëƒÉng nh·∫≠p!'); return; }

            var submitBtn = document.querySelector('#jobForm button[type="submit"]');
            if(submitBtn){ submitBtn.disabled = true; submitBtn.textContent = 'ƒêang ƒëƒÉng...'; }

            var uploadPromise = Promise.resolve(null);
            if(selectedFile) uploadPromise = uploadImage(selectedFile);

            uploadPromise
                .then(function(imageUrl){
                    var jobData = {
                        user_id: currentUser.id,
                        title: document.getElementById('title').value,
                        company: document.getElementById('company').value,
                        description: document.getElementById('description').value,
                        job_type: document.getElementById('job_type').value,
                        salary: document.getElementById('salary').value,
                        location: document.getElementById('location').value,
                        city: document.getElementById('city').value,
                        zipcode: document.getElementById('zipcode').value,
                        contact: document.getElementById('contact').value,
                        image_url: imageUrl,
                        status: 'active',
                        views: 0
                    };
                    return supabase.from('jobs').insert([jobData]).select();
                })
                .then(function(response){
                    if(response.error) throw response.error;
                    console.log('‚úÖ Job saved successfully');
                    alert('ƒêƒÉng tin th√†nh c√¥ng!');
                    closeModal();
                    loadJobs();
                })
                .catch(function(error){
                    console.error('‚ùå Error:', error);
                    alert('L·ªói: ' + (error.message || 'Kh√¥ng x√°c ƒë·ªãnh'));
                })
                .finally(function(){
                    if(submitBtn){ submitBtn.disabled = false; submitBtn.textContent = 'ƒêƒÉng tin'; }
                });
        }

        function uploadImage(file){
            console.log('üì§ Uploading image...');
            var fileName = 'job_' + Date.now() + '_' + Math.random().toString(36).substring(2) + '.' + file.name.split('.').pop();
            return supabase.storage.from('marketplace').upload('jobs/' + fileName, file)
                .then(function(response){
                    if(response.error) throw response.error;
                    var urlResponse = supabase.storage.from('marketplace').getPublicUrl('jobs/' + fileName);
                    console.log('‚úÖ Image uploaded:', urlResponse.data.publicUrl);
                    return urlResponse.data.publicUrl;
                });
        }

        function closeModal(){
            var modal = document.getElementById('jobModal');
            var form = document.getElementById('jobForm');
            var preview = document.getElementById('uploadPreview');
            var text = document.getElementById('uploadText');
            if(modal) modal.style.display = 'none';
            if(form) form.reset();
            selectedFile = null;
            if(preview && text){ preview.style.display = 'none'; text.style.display = 'block'; preview.innerHTML = ''; }
        }
        window.closeModal = closeModal;

        function closeDetailModal(){
            var modal = document.getElementById('detailModal');
            if(modal) modal.style.display = 'none';
        }
        window.closeDetailModal = closeDetailModal;

        function viewJobDetail(jobData){
            console.log('üëÅÔ∏è Viewing job detail:', jobData);
            if(!jobData){ console.error('‚ùå No job data provided'); return; }

            var newViews = (jobData.views || 0) + 1;
            supabase.from('jobs').update({ views: newViews }).eq('id', jobData.id)
                .then(function(){
                    console.log('‚úÖ View count updated');
                    jobData.views = newViews;
                    displayJobDetail(jobData);
                    setTimeout(loadJobs, 800);
                })
                .catch(function(error){
                    console.error('‚ö†Ô∏è Could not update view count:', error);
                    displayJobDetail(jobData);
                });
        }

        function displayJobDetail(job){
            console.log('üìã Displaying job detail');
            var detailContent = document.getElementById('detailContent');
            if(!detailContent) return;

            var locationInfo = [];
            if(job.city) locationInfo.push(job.city);
            if(job.zipcode) locationInfo.push(job.zipcode);
            var fullLocation = locationInfo.join(', ');

            var createdDate = new Date(job.created_at);
            var formattedDate = createdDate.toLocaleDateString('vi-VN');

            var html = '<div class="detail-header">';
            html += '<div class="detail-image">';
            html += job.image_url ? '<img src="'+ escapeHtml(job.image_url) +'" alt="Job">' : 'üè¢';
            html += '</div>';
            html += '<div class="detail-info">';
            html += '<h3>'+ escapeHtml(job.title || '') +'</h3>';
            html += '<div class="detail-company">'+ escapeHtml(job.company || '') +'</div>';
            html += '<div class="detail-type">'+ escapeHtml(job.job_type || '') +'</div>';
            html += '</div></div>';

            html += '<div class="detail-description">'+ escapeHtml(job.description || '') +'</div>';

            html += '<div class="detail-grid">';
            if(job.salary){
                html += '<div class="detail-item"><span class="icon">üíµ</span><span><strong>M·ª©c l∆∞∆°ng:</strong> '+ escapeHtml(job.salary) +'</span></div>';
            }
            if(job.location){
                html += '<div class="detail-item"><span class="icon">üìç</span><span><strong>ƒê·ªãa ch·ªâ:</strong> '+ escapeHtml(job.location) +'</span></div>';
            }
            if(fullLocation){
                html += '<div class="detail-item"><span class="icon">üèôÔ∏è</span><span><strong>Khu v·ª±c:</strong> '+ escapeHtml(fullLocation) +'</span></div>';
            }
            html += '<div class="detail-item"><span class="icon">üìû</span><span><strong>Li√™n h·ªá:</strong> '+ escapeHtml(job.contact || '') +'</span></div>';
            html += '<div class="detail-item"><span class="icon">üëÅÔ∏è</span><span><strong>L∆∞·ª£t xem:</strong> '+ (job.views || 0) +'</span></div>';
            html += '<div class="detail-item"><span class="icon">üìÖ</span><span><strong>ƒêƒÉng ng√†y:</strong> '+ escapeHtml(formattedDate) +'</span></div>';
            html += '</div>';

            detailContent.innerHTML = html;
            var modal = document.getElementById('detailModal');
            if(modal) modal.style.display = 'block';
        }

        function loadJobs(jobType, searchTerm, location, salary){
            console.log('üì• Loading jobs...');
            var container = document.getElementById('jobsContainer');
            if(container) container.innerHTML = '<div class="loading">ƒêang t·∫£i vi·ªác l√†m...</div>';

            var query = supabase.from('jobs').select('*').eq('status', 'active').order('created_at', { ascending: false });

            if(jobType){ query = query.eq('job_type', jobType); }
            if(searchTerm){
                // Note: special chars in searchTerm may affect filter parsing on Supabase
                query = query.or(
                    'title.ilike.%'+ searchTerm +'%,company.ilike.%'+ searchTerm +'%,description.ilike.%'+ searchTerm +'%'
                );
            }
            if(location){
                if(/^\d{5}$/.test(location)){ query = query.eq('zipcode', location); }
                else{ query = query.ilike('city', '%'+ location +'%'); }
            }

            query.then(function(response){
                if(response.error) throw response.error;

                var jobs = response.data || [];
                // Client-side salary filter
                if(salary){
                    jobs = jobs.filter(function(j){ return salaryMatchesFilter(j.salary, salary); });
                }

                allJobs = jobs;
                console.log('‚úÖ Jobs loaded:', jobs.length);
                if(!container) return;

                if(jobs.length === 0){
                    container.innerHTML = '<div class="empty-state"><h3>Kh√¥ng t√¨m th·∫•y vi·ªác l√†m n√†o</h3></div>';
                    return;
                }

                var html = '';
                for(var i=0;i<jobs.length;i++){
                    var job = jobs[i];
                    var locationInfo = [];
                    if(job.city) locationInfo.push(job.city);
                    if(job.zipcode) locationInfo.push(job.zipcode);
                    var fullLocation = locationInfo.join(', ');

                    html += '<div class="job-card" data-job-index="'+ i +'">';
                    html += '  <div class="job-image">';
                    html += job.image_url ? '<img src="'+ escapeHtml(job.image_url) +'" alt="Job">' : 'üè¢';
                    html += '  </div>';
                    html += '  <div class="job-content">';
                    html += '    <div class="job-header">';
                    html += '      <div>';
                    html += '        <div class="job-title">'+ escapeHtml(job.title || '') +'</div>';
                    html += '        <div class="company-name">'+ escapeHtml(job.company || '') +'</div>';
                    html += '      </div>';
                    html += '      <div class="job-type">'+ escapeHtml(job.job_type || '') +'</div>';
                    html += '    </div>';
                    html += '    <div class="job-description">'+ escapeHtml(job.description || '') +'</div>';
                    html += '    <div class="job-details">';
                    if(job.salary){
                        html += '      <div class="job-detail-item"><span class="icon">üíµ</span><span>'+ escapeHtml(job.salary) +'</span></div>';
                    }
                    if(job.location){
                        html += '      <div class="job-detail-item"><span class="icon">üìç</span><span>'+ escapeHtml(job.location) +'</span></div>';
                    }
                    if(fullLocation){
                        html += '      <div class="job-detail-item"><span class="icon">üèôÔ∏è</span><span>'+ escapeHtml(fullLocation) +'</span></div>';
                    }
                    html += '      <div class="job-detail-item"><span class="icon">üìû</span><span>'+ escapeHtml(job.contact || '') +'</span></div>';
                    html += '    </div>';
                    html += '    <div class="view-count">üëÅÔ∏è '+ (job.views || 0) +' l∆∞·ª£t xem</div>';
                    html += '  </div>';
                    html += '</div>';
                }

                container.innerHTML = html;

                var jobCards = container.querySelectorAll('.job-card');
                for(var j=0;j<jobCards.length;j++){
                    (function(card){
                        card.onclick = function(){
                            var index = parseInt(card.getAttribute('data-job-index'));
                            console.log('üì± Job card clicked, index:', index);
                            if(!isNaN(index) && allJobs[index]) viewJobDetail(allJobs[index]);
                        };
                    })(jobCards[j]);
                }
            })
            .catch(function(error){
                console.error('‚ùå Error loading jobs:', error);
                if(container) container.innerHTML = '<div class="empty-state">L·ªói khi t·∫£i d·ªØ li·ªáu</div>';
            });
        }
    </script>
</body>
</html>
